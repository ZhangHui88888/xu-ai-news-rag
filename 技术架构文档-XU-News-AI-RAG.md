# XU-News-AI-RAG 技术架构文档

**版本：** 1.0  
**日期：** 2025年10月15日  
**项目代号：** xu-ai-news-rag  

---

## 文档说明

本文档描述XU-News-AI-RAG个性化新闻智能知识库系统的技术架构设计，包括系统架构、技术选型、部署方案等内容。

**关联文档：**
- 《XU-News-AI-RAG产品需求文档 v1.0》
- 《XU-News-AI-RAG概要设计文档 v1.0》
- 《XU-News-AI-RAG产品原型设计文档 v1.0》

---

## 目录

1. [架构概述](#1-架构概述)
2. [系统架构设计](#2-系统架构设计)
3. [技术选型说明](#3-技术选型说明)
4. [部署架构设计](#4-部署架构设计)
5. [技术风险与对策](#5-技术风险与对策)

---

## 1. 架构概述

### 1.1 架构原则

| 原则 | 说明 | 实现方式 |
|------|------|----------|
| **分层架构** | 职责清晰，便于维护 | 展示层、应用层、服务层、数据层 |
| **前后端分离** | 提高开发效率 | Vue前端 + Spring Boot后端 |
| **本地化部署** | 数据隐私可控 | 所有组件本地部署 |
| **微服务思想** | 模块解耦，易扩展 | 按功能划分独立模块 |
| **AI驱动** | 智能化处理 | 集成本地大模型和向量检索 |

### 1.2 核心技术栈

```
┌────────────────────────────────────────────────────────┐
│                      前端层                             │
│              Vue 3 + Element Plus                      │
│          ✅ 符合课程要求（Vue框架）                     │
└───────────────────┬────────────────────────────────────┘
                    │ HTTP REST API
                    ↓
┌────────────────────────────────────────────────────────┐
│                  工作流编排层                           │
│                      n8n                               │
│   RSS采集 | AI处理 | RAG问答 | 定时任务               │
│          ✅ 符合课程要求（n8n工作流）                   │
└───────────────────┬────────────────────────────────────┘
                    │ Webhook + HTTP
                    ↓
┌────────────────────────────────────────────────────────┐
│                  应用服务层                             │
│                 Spring Boot                            │
│   数据管理 | 用户认证 | 向量检索 | API网关            │
│      ✅ 符合课程要求（SpringBoot框架）                  │
└───────────────────┬────────────────────────────────────┘
                    │
        ┌───────────┴───────────┐
        ↓                       ↓
┌──────────────┐        ┌──────────────┐
│    MySQL     │        │    FAISS     │
│  (关系数据)  │        │  (向量数据)  │
│ ✅ 课程要求  │        │ ✅ 课程要求  │
└──────────────┘        └──────────────┘
```

### 1.3 技术特色

- **本地大模型部署** - 使用Ollama + Qwen 2.5，无需云端API
- **RAG技术** - 结合向量检索和大模型生成，提供准确回答
- **n8n工作流编排** - 可视化配置数据处理流程，降低开发门槛
- **前后端分离** - Vue单页应用 + Spring Boot RESTful API
- **完全本地化** - 所有数据和服务均在本地运行

---

## 2. 系统架构设计

### 2.1 整体架构图

```
┌─────────────────────────────────────────────────────────────────┐
│                          用户层                                  │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │            浏览器（Web用户界面）                          │   │
│  │  🏠 首页  |  🔍 搜索  |  💬 问答  |  📚 知识库  |  ⚙️ 数据源│   │
│  └──────────────────────────────────────────────────────────┘   │
└──────────────────────────┬──────────────────────────────────────┘
                           │ HTTPS/HTTP
                           ↓
┌─────────────────────────────────────────────────────────────────┐
│                         展示层                                   │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                  Vue 3 单页应用 (SPA)                     │   │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌─────────┐  │   │
│  │  │ 首页组件 │  │ 搜索组件 │  │ 问答组件 │  │ 管理组件│  │   │
│  │  └──────────┘  └──────────┘  └──────────┘  └─────────┘  │   │
│  │           Element Plus UI组件库                          │   │
│  │           Axios HTTP客户端                               │   │
│  │           Vue Router路由管理                             │   │
│  └──────────────────────────────────────────────────────────┘   │
└──────────────────────────┬──────────────────────────────────────┘
                           │ REST API (JSON)
                           ↓
┌─────────────────────────────────────────────────────────────────┐
│                      工作流编排层                                │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                      n8n工作流引擎                        │   │
│  │  ┌────────────────┐  ┌────────────────┐  ┌───────────┐  │   │
│  │  │ RSS新闻采集    │  │ RAG智能问答    │  │ 文档处理  │  │   │
│  │  │ 工作流         │  │ 工作流         │  │ 工作流    │  │   │
│  │  │                │  │                │  │           │  │   │
│  │  │ • Cron触发     │  │ • Webhook触发  │  │ • 上传触发│  │   │
│  │  │ • RSS Reader   │  │ • 向量化问题   │  │ • 解析PDF│  │   │
│  │  │ • HTML解析     │  │ • 向量检索     │  │ • 提取文本│  │   │
│  │  │ • Qwen摘要     │  │ • Qwen生成答案 │  │ • 分段处理│  │   │
│  │  │ • Ollama向量化 │  │ • 返回结果     │  │ • 批量导入│  │   │
│  │  │ • 保存数据     │  │                │  │           │  │   │
│  │  └────────────────┘  └────────────────┘  └───────────┘  │   │
│  └──────────────────────────────────────────────────────────┘   │
└──────────────────────────┬──────────────────────────────────────┘
                           │ HTTP POST/Webhook
                           ↓
┌─────────────────────────────────────────────────────────────────┐
│                        应用服务层                                │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │            Spring Boot RESTful API服务                    │   │
│  │  ┌──────────┬──────────┬──────────┬──────────┬─────────┐ │   │
│  │  │ 用户认证 │ 知识库   │ 向量检索 │ 数据源   │ 统计分析│ │   │
│  │  │ Controller│ Controller│ Service │ Controller│ Service │ │   │
│  │  │          │          │          │          │         │ │   │
│  │  │ • 注册   │ • CRUD   │ • FAISS  │ • 源管理 │ • 图表  │ │   │
│  │  │ • 登录   │ • 搜索   │ • 向量化 │ • 测试   │ • 统计  │ │   │
│  │  │ • JWT    │ • 标签   │ • 检索   │ • 日志   │ • 导出  │ │   │
│  │  └──────────┴──────────┴──────────┴──────────┴─────────┘ │   │
│  │                                                            │   │
│  │  ┌──────────────────────────────────────────────────────┐│   │
│  │  │         Spring Security + JWT 安全框架                ││   │
│  │  └──────────────────────────────────────────────────────┘│   │
│  │                                                            │   │
│  │  ┌──────────────────────────────────────────────────────┐│   │
│  │  │            MyBatis Plus ORM框架                       ││   │
│  │  └──────────────────────────────────────────────────────┘│   │
│  └──────────────────────────────────────────────────────────┘   │
└──────────────────────────┬──────────────────────────────────────┘
                           │
                           ↓
┌─────────────────────────────────────────────────────────────────┐
│                         AI服务层                                 │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                   Ollama本地服务                          │   │
│  │  ┌────────────────┐  ┌────────────────┐                  │   │
│  │  │ Qwen 2.5:3b    │  │ all-MiniLM-L6  │                  │   │
│  │  │ (文本生成模型)  │  │ (向量化模型)    │                  │   │
│  │  │                │  │                │                  │   │
│  │  │ • 新闻摘要生成  │  │ • 文本向量化   │                  │   │
│  │  │ • RAG问答      │  │ • 语义检索     │                  │   │
│  │  │ • 内容总结     │  │ • 相似度计算   │                  │   │
│  │  └────────────────┘  └────────────────┘                  │   │
│  └──────────────────────────────────────────────────────────┘   │
└──────────────────────────┬──────────────────────────────────────┘
                           │
                           ↓
┌─────────────────────────────────────────────────────────────────┐
│                         数据存储层                               │
│  ┌──────────────────┐  ┌──────────────────┐  ┌──────────────┐  │
│  │   MySQL 8.0      │  │   FAISS向量库    │  │ 本地文件系统 │  │
│  │  (关系型数据)    │  │   (向量数据)     │  │  (上传文件)  │  │
│  │                  │  │                  │  │              │  │
│  │ • 用户信息       │  │ • 384维向量      │  │ • PDF文档    │  │
│  │ • 知识条目元数据 │  │ • FAISS索引      │  │ • Word文档   │  │
│  │ • 数据源配置     │  │ • 向量ID映射     │  │ • TXT文本    │  │
│  │ • 标签关系       │  │                  │  │ • 日志文件   │  │
│  │ • 检索历史       │  │                  │  │              │  │
│  │ • 采集日志       │  │                  │  │              │  │
│  └──────────────────┘  └──────────────────┘  └──────────────┘  │
└─────────────────────────────────────────────────────────────────┘
```

### 2.2 架构分层说明

#### 2.2.1 展示层（Presentation Layer）

**技术：** Vue 3 + Element Plus

**职责：**
- 用户界面渲染
- 用户交互处理
- 前端路由管理
- 状态管理
- API调用封装

**特点：**
- 单页应用（SPA）架构
- 组件化开发
- 响应式设计
- 前端路由（Vue Router）

#### 2.2.2 工作流编排层（Workflow Orchestration Layer）

**技术：** n8n

**职责：**
- 数据采集流程编排（RSS、网页）
- AI处理流程编排（摘要、向量化）
- RAG问答流程编排
- 定时任务调度
- 错误处理和重试

**特点：**
- 可视化配置
- 低代码开发
- 内置AI节点
- 灵活的流程控制

#### 2.2.3 应用服务层（Application Service Layer）

**技术：** Spring Boot

**职责：**
- RESTful API提供
- 业务逻辑处理
- 数据持久化
- 用户认证和授权
- 向量检索服务
- 系统日志记录

**特点：**
- 微服务架构思想
- 模块化设计
- 统一异常处理
- 事务管理

#### 2.2.4 AI服务层（AI Service Layer）

**技术：** Ollama + Qwen + all-MiniLM

**职责：**
- 大语言模型推理
- 文本向量化
- 语义理解
- 内容生成

**特点：**
- 本地部署
- 离线运行
- 隐私保护

#### 2.2.5 数据存储层（Data Storage Layer）

**技术：** MySQL + FAISS + 文件系统

**职责：**
- 结构化数据存储（MySQL）
- 向量数据存储（FAISS）
- 文件数据存储（本地FS）
- 数据备份和恢复

**特点：**
- 数据分类存储
- 高效检索
- 数据安全

---

## 3. 技术选型说明

### 3.1 前端技术选型

#### 3.1.1 Vue 3 vs React

| 对比项 | Vue 3 | React | 选择 |
|--------|-------|-------|------|
| 学习曲线 | 平缓，文档完善 | 陡峭，概念较多 | **Vue 3** ✅ |
| 开发效率 | 高，模板语法直观 | 中，JSX需适应 | **Vue 3** ✅ |
| 生态成熟度 | 成熟，Element Plus | 非常成熟 | Vue 3 |
| 课程要求 | ✅ 符合 | ✅ 符合 | **Vue 3** ✅ |
| 性能 | 优秀 | 优秀 | 相当 |

**选择理由：**
- ✅ 符合课程要求
- ✅ 学习曲线平缓，开发效率高
- ✅ Element Plus UI组件库成熟完善
- ✅ 中文文档友好

#### 3.1.2 UI组件库选择

**Element Plus** ✅
- 基于Vue 3
- 组件丰富（80+）
- 中文文档完善
- 企业级应用成熟

**备选方案：**
- Ant Design Vue（功能更强大，但较重）
- Naive UI（较新，生态不如Element Plus）

### 3.2 后端技术选型

#### 3.2.1 Spring Boot vs Flask

| 对比项 | Spring Boot | Flask | 选择 |
|--------|-------------|-------|------|
| 开发语言 | Java | Python | **Spring Boot** ✅ |
| 企业级特性 | 完善（Security、事务等） | 基础，需扩展 | **Spring Boot** ✅ |
| ORM支持 | MyBatis Plus、JPA | SQLAlchemy | **Spring Boot** ✅ |
| 性能 | 高 | 中 | **Spring Boot** ✅ |
| 课程要求 | ✅ 符合 | ✅ 符合 | **Spring Boot** ✅ |
| 学习成本 | 中等 | 低 | Flask |

**选择理由：**
- ✅ 符合课程要求
- ✅ 企业级特性完善（Spring Security、事务管理）
- ✅ 更适合构建大型应用
- ✅ 团队Java技能储备

#### 3.2.2 ORM框架选择

**MyBatis Plus** ✅
- 基于MyBatis
- 简化CRUD操作
- 支持分页、代码生成
- Lambda表达式查询

**备选方案：**
- Spring Data JPA（更抽象，但灵活性稍差）

### 3.3 数据库技术选型

#### 3.3.1 MySQL vs SQLite

| 对比项 | MySQL | SQLite | 选择 |
|--------|-------|--------|------|
| 并发性能 | 高，支持多连接 | 低，单文件锁 | **MySQL** ✅ |
| 功能特性 | 完整（全文索引、JSON等） | 基础 | **MySQL** ✅ |
| 扩展性 | 强（主从、分库分表） | 弱 | **MySQL** ✅ |
| 部署复杂度 | 中等 | 低 | SQLite |
| 课程要求 | ✅ 符合 | ✅ 符合 | **MySQL** ✅ |

**选择理由：**
- ✅ 符合课程要求
- ✅ 企业级数据库，功能完整
- ✅ 支持高并发，便于扩展
- ✅ 完整的全文索引支持

#### 3.3.2 向量数据库选择

**FAISS** ✅
- Facebook开源
- 性能优异
- 支持多种索引类型
- 完全本地化
- ✅ 符合课程要求

**备选方案：**
- Milvus（功能更强，但过重）
- Qdrant（较新，生态不成熟）

### 3.4 AI技术选型

#### 3.4.1 LLM框架选择

**LangChain4j** ✅
- LangChain的Java官方实现
- 完整的RAG支持
- 与Spring Boot无缝集成
- ✅ 符合课程要求（LangChain框架）

**关键特性：**
- 支持Ollama、OpenAI等多种模型
- 内置向量存储抽象
- 完整的Prompt模板系统

#### 3.4.2 大模型选择

**Ollama + Qwen 2.5:3b** ✅
- 本地部署，数据隐私
- OpenAI兼容API
- Qwen中文能力强
- 3B参数量，适合本地运行

**备选方案：**
- LLaMA系列（英文为主）
- ChatGLM（部署较复杂）

#### 3.4.3 Embedding模型选择

**all-MiniLM-L6-v2** ✅
- 轻量级（80MB）
- 384维向量
- 多语言支持
- 性能优秀

### 3.5 工作流引擎选择

**n8n** ✅
- 低代码工作流平台
- 内置AI节点
- 可视化配置
- ✅ 符合课程要求

**在项目中的作用：**
- RSS新闻采集
- 网页内容抓取
- AI摘要生成
- 向量化处理
- RAG问答流程编排

**优势：**
- 降低开发门槛
- 可视化调试
- 灵活的流程控制
- 丰富的内置节点

---

## 4. 部署架构设计

### 4.1 单机部署架构（推荐）

```
┌─────────────────────────────────────────────────────────┐
│                      服务器主机                          │
│  ┌──────────────────────────────────────────────────┐   │
│  │  Nginx (80/443)                                  │   │
│  │   - 静态资源服务                                  │   │
│  │   - 反向代理                                      │   │
│  │   - HTTPS终止                                     │   │
│  └────────┬──────────────────────────────────────────┘   │
│           │ 反向代理                                      │
│  ┌────────▼──────────────────────────────────────────┐   │
│  │  Vue 3前端 (3000)                                │   │
│  │   npm run dev / npm run build                    │   │
│  └──────────────────────────────────────────────────┘   │
│                                                          │
│  ┌──────────────────────────────────────────────────┐   │
│  │  n8n (5678)                                      │   │
│  │   Docker运行                                      │   │
│  │   - 工作流管理界面                                │   │
│  │   - Webhook接收                                   │   │
│  └──────────────────────────────────────────────────┘   │
│                                                          │
│  ┌──────────────────────────────────────────────────┐   │
│  │  Spring Boot (8080)                              │   │
│  │   java -jar app.jar                              │   │
│  └────────┬─────────────────────────────────────────┘   │
│           │                                              │
│  ┌────────▼──────────────────────────────────────────┐   │
│  │  MySQL (3306)                                    │   │
│  │   systemctl start mysql                          │   │
│  └──────────────────────────────────────────────────┘   │
│                                                          │
│  ┌──────────────────────────────────────────────────┐   │
│  │  Ollama (11434)                                  │   │
│  │   ollama serve                                   │   │
│  │   - qwen2.5:3b                                   │   │
│  │   - all-minilm-l6-v2                             │   │
│  └──────────────────────────────────────────────────┘   │
│                                                          │
│  ┌──────────────────────────────────────────────────┐   │
│  │  数据目录                                         │   │
│  │   /data/                                         │   │
│  │   ├── faiss/        (FAISS索引)                  │   │
│  │   ├── uploads/      (上传文件)                   │   │
│  │   └── logs/         (日志文件)                   │   │
│  └──────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────┘
```

#### 4.1.1 端口分配

| 服务 | 端口 | 协议 | 说明 |
|------|------|------|------|
| Nginx | 80 | HTTP | Web访问入口 |
| Nginx | 443 | HTTPS | 加密访问（可选） |
| Vue前端 | 3000 | HTTP | 开发环境端口 |
| Spring Boot | 8080 | HTTP | REST API服务 |
| n8n | 5678 | HTTP | n8n工作流管理 |
| MySQL | 3306 | TCP | 数据库连接 |
| Ollama | 11434 | HTTP | AI模型服务 |

### 4.2 Docker容器化部署

#### 4.2.1 Docker Compose配置

```yaml
version: '3.8'

services:
  nginx:
    image: nginx:latest
    container_name: xu-news-nginx
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./frontend/dist:/usr/share/nginx/html
      - ./ssl:/etc/nginx/ssl
    depends_on:
      - backend
      - frontend
    networks:
      - app-network

  mysql:
    image: mysql:8.0
    container_name: xu-news-mysql
    ports:
      - "3306:3306"
    environment:
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
      MYSQL_DATABASE: xu_news_rag
      MYSQL_USER: xu_user
      MYSQL_PASSWORD: ${MYSQL_PASSWORD}
      TZ: Asia/Shanghai
    volumes:
      - mysql-data:/var/lib/mysql
      - ./init.sql:/docker-entrypoint-initdb.d/init.sql
    command:
      - --character-set-server=utf8mb4
      - --collation-server=utf8mb4_unicode_ci
      - --default-authentication-plugin=mysql_native_password
    networks:
      - app-network
    healthcheck:
      test: ["CMD", "mysqladmin", "ping", "-h", "localhost"]
      interval: 10s
      timeout: 5s
      retries: 5

  backend:
    build: ./backend
    container_name: xu-news-backend
    ports:
      - "8080:8080"
    environment:
      SPRING_PROFILES_ACTIVE: production
      SPRING_DATASOURCE_URL: jdbc:mysql://mysql:3306/xu_news_rag?useUnicode=true&characterEncoding=utf8
      SPRING_DATASOURCE_USERNAME: xu_user
      SPRING_DATASOURCE_PASSWORD: ${MYSQL_PASSWORD}
      N8N_WEBHOOK_BASE_URL: http://n8n:5678/webhook
      OLLAMA_BASE_URL: http://ollama:11434
    volumes:
      - ./data:/app/data
      - ./logs:/app/logs
    depends_on:
      mysql:
        condition: service_healthy
      n8n:
        condition: service_started
      ollama:
        condition: service_started
    networks:
      - app-network

  n8n:
    image: n8nio/n8n:latest
    container_name: xu-news-n8n
    ports:
      - "5678:5678"
    environment:
      N8N_BASIC_AUTH_ACTIVE: "true"
      N8N_BASIC_AUTH_USER: admin
      N8N_BASIC_AUTH_PASSWORD: ${N8N_PASSWORD}
      WEBHOOK_URL: http://n8n:5678/
      GENERIC_TIMEZONE: Asia/Shanghai
    volumes:
      - n8n-data:/home/node/.n8n
    networks:
      - app-network

  ollama:
    image: ollama/ollama:latest
    container_name: xu-news-ollama
    ports:
      - "11434:11434"
    volumes:
      - ollama-data:/root/.ollama
    networks:
      - app-network
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]
        # GPU可选，CPU也可运行

  frontend:
    build: ./frontend
    container_name: xu-news-frontend
    ports:
      - "3000:3000"
    environment:
      VITE_API_BASE_URL: http://backend:8080
    networks:
      - app-network

volumes:
  mysql-data:
  n8n-data:
  ollama-data:

networks:
  app-network:
    driver: bridge
```

#### 4.2.2 一键启动脚本

```bash
#!/bin/bash
# deploy.sh - 一键部署脚本

echo "🚀 开始部署XU-News-AI-RAG系统..."

# 1. 检查Docker和Docker Compose
if ! command -v docker &> /dev/null; then
    echo "❌ Docker未安装，请先安装Docker"
    exit 1
fi

if ! command -v docker-compose &> /dev/null; then
    echo "❌ Docker Compose未安装"
    exit 1
fi

# 2. 创建必要的目录
mkdir -p data/faiss data/uploads logs

# 3. 配置环境变量
if [ ! -f .env ]; then
    echo "📝 创建环境变量文件..."
    cat > .env << EOF
MYSQL_ROOT_PASSWORD=root123456
MYSQL_PASSWORD=xu_password
N8N_PASSWORD=admin123
JWT_SECRET=$(openssl rand -base64 32)
EOF
fi

# 4. 构建镜像
echo "🔨 构建Docker镜像..."
docker-compose build

# 5. 启动服务
echo "▶️  启动服务..."
docker-compose up -d

# 6. 等待服务就绪
echo "⏳ 等待服务启动..."
sleep 10

# 7. 检查服务状态
docker-compose ps

# 8. 初始化Ollama模型
echo "📥 下载AI模型（首次运行需要几分钟）..."
docker exec xu-news-ollama ollama pull qwen2.5:3b
docker exec xu-news-ollama ollama pull all-minilm-l6-v2

echo "✅ 部署完成！"
echo ""
echo "📋 访问地址："
echo "   前端：http://localhost"
echo "   后端API：http://localhost:8080"
echo "   n8n管理：http://localhost:5678"
echo ""
echo "👤 默认账号："
echo "   n8n: admin / admin123"
```

### 4.3 系统要求

#### 4.3.1 硬件要求

| 环境 | CPU | 内存 | 硬盘 | GPU |
|------|-----|------|------|-----|
| **最低配置** | 4核 | 8GB | 50GB SSD | 无 |
| **推荐配置** | 8核+ | 16GB+ | 200GB SSD | NVIDIA GPU（可选） |

**说明：**
- Ollama在CPU上也能运行，GPU可加速推理
- FAISS向量检索对内存有一定要求
- MySQL和文件存储需要足够的硬盘空间

#### 4.3.2 软件要求

| 软件 | 版本 | 必需性 |
|------|------|--------|
| 操作系统 | Ubuntu 20.04+ / Windows 10+ / macOS 11+ | 必需 |
| Docker | 20.10+ | 推荐 |
| Docker Compose | 2.0+ | 推荐 |
| JDK | 17+ | 必需（非Docker部署） |
| Maven | 3.8+ | 必需（非Docker部署） |
| MySQL | 8.0+ | 必需（非Docker部署） |
| Node.js | 16+ | 必需（前端开发） |
| Ollama | Latest | 必需 |

### 4.4 网络架构

```
Internet
    │
    ↓
┌─────────────────────┐
│   防火墙（可选）     │
│   - 端口: 80, 443    │
└──────────┬──────────┘
           │
           ↓
    ┌─────────────┐
    │   Nginx     │
    │  反向代理    │
    └──────┬──────┘
           │
    ┌──────┴───────────┐
    │                  │
    ↓                  ↓
┌─────────┐      ┌─────────────┐
│ 前端静态 │      │ Spring Boot │
│ 资源     │      │ 后端API     │
└─────────┘      └──────┬──────┘
                        │
                 ┌──────┴──────┐
                 │             │
                 ↓             ↓
            ┌────────┐    ┌────────┐
            │ MySQL  │    │ n8n    │
            └────────┘    └────────┘
```

---

## 5. 技术风险与对策

### 5.1 性能风险

| 风险 | 影响 | 概率 | 对策 |
|------|------|------|------|
| **Ollama推理慢** | 问答响应慢 | 中 | • 使用较小模型（3B）<br>• Prompt优化减少token<br>• 考虑GPU加速 |
| **FAISS索引重建慢** | 更新延迟 | 中 | • 增量更新<br>• 后台异步重建<br>• 选择合适索引类型 |
| **MySQL查询慢** | 搜索响应慢 | 低 | • 建立完整索引<br>• 查询优化<br>• 使用HikariCP连接池 |
| **前端加载慢** | 用户体验差 | 低 | • 代码分割<br>• 懒加载<br>• CDN加速（可选） |

### 5.2 可用性风险

| 风险 | 影响 | 概率 | 对策 |
|------|------|------|------|
| **n8n工作流失败** | 采集中断 | 中 | • 错误处理机制<br>• 自动重试<br>• 告警通知 |
| **磁盘空间不足** | 系统崩溃 | 中 | • 监控磁盘使用<br>• 数据清理策略<br>• 日志轮转 |
| **MySQL连接池耗尽** | 服务不可用 | 低 | • 合理配置连接池<br>• 超时设置<br>• 连接泄漏检测 |

### 5.3 安全风险

| 风险 | 影响 | 概率 | 对策 |
|------|------|------|------|
| **SQL注入** | 数据泄露 | 低 | • 使用MyBatis参数化查询<br>• 输入验证 |
| **XSS攻击** | 客户端安全 | 低 | • Vue自动转义<br>• CSP策略 |
| **JWT泄露** | 身份盗用 | 中 | • HTTPS传输<br>• Token过期机制<br>• Refresh Token |
| **n8n未授权访问** | 配置泄露 | 中 | • 启用Basic Auth<br>• 内网部署<br>• IP白名单 |

### 5.4 技术债务管理

**优先级排序：**

**P0 - 必须解决：**
- JWT安全配置
- 数据库索引优化
- 错误处理完善

**P1 - 应该解决：**
- 日志系统完善
- 监控告警
- 单元测试覆盖

**P2 - 可以延后：**
- 性能监控面板
- A/B测试框架
- 多语言支持

---

## 6. 技术演进路线

### 6.1 当前版本（v1.0）

**已实现：**
- ✅ 基础架构搭建
- ✅ 核心功能实现
- ✅ 本地化部署
- ✅ 单机运行

### 6.2 近期优化（v1.1 - v1.5）

**3个月内：**
- 引入Redis缓存
- 性能监控完善
- 单元测试覆盖
- Docker优化

### 6.3 中期规划（v2.0）

**6个月内：**
- 支持多用户
- 数据库读写分离
- 微服务拆分（可选）
- 移动端H5页面

### 6.4 长期愿景（v3.0+）

**1年内：**
- 分布式部署
- 多模态支持（图片、视频）
- 联邦学习（隐私保护）
- SaaS服务化

---

## 7. 附录

### 7.1 参考架构

**类似系统：**
- Notion（知识库管理）
- Feedly（RSS阅读器）
- ChatGPT（智能问答）

**技术参考：**
- LangChain官方示例
- n8n工作流模板
- Spring Boot最佳实践

### 7.2 关键技术文档

- [Spring Boot官方文档](https://spring.io/projects/spring-boot)
- [Vue 3官方文档](https://cn.vuejs.org/)
- [n8n官方文档](https://docs.n8n.io/)
- [Ollama文档](https://github.com/ollama/ollama)
- [FAISS Wiki](https://github.com/facebookresearch/faiss/wiki)
- [LangChain4j文档](https://docs.langchain4j.dev/)

---

**文档版本：** 1.0  
**最后更新：** 2025年10月15日  
**架构师：** XU技术团队

**审批流程：**
- [ ] 技术负责人审批
- [ ] 架构师审批
- [ ] 项目经理审批

---

## 结论

本技术架构采用**Vue 3 + n8n + Spring Boot + MySQL + FAISS**的组合方案，完全符合课程要求，具有以下特点：

1. **技术栈成熟稳定** - 所有组件均为主流技术
2. **架构清晰合理** - 分层明确，职责清晰
3. **本地化部署** - 数据隐私可控
4. **易于开发维护** - n8n可视化配置降低门槛
5. **性能优异** - 向量检索快速，大模型本地运行

该架构能够满足个性化新闻智能知识库的所有功能需求，同时具备良好的扩展性和维护性。

